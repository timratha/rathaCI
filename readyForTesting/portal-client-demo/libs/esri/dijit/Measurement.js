// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.12/esri/copyright.txt for details.
//>>built
require({cache:{"dijit/_KeyNavContainer":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/_base/kernel dojo/keys dojo/_base/lang ./registry ./_Container ./_FocusMixin ./_KeyNavMixin".split(" "),function(l,m,c,f,b,h,n,e,a,q){return m("dijit._KeyNavContainer",[a,q,e],{connectKeyNavHandlers:function(a,c){var f=this._keyNavCodes={},g=h.hitch(this,"focusPrev"),e=h.hitch(this,"focusNext");l.forEach(a,function(a){f[a]=g});l.forEach(c,function(a){f[a]=e});f[b.HOME]=h.hitch(this,"focusFirstChild");
f[b.END]=h.hitch(this,"focusLastChild")},startupKeyNavChildren:function(){f.deprecated("startupKeyNavChildren() call no longer needed","","2.0")},startup:function(){this.inherited(arguments);l.forEach(this.getChildren(),h.hitch(this,"_startupChild"))},addChild:function(a,b){this.inherited(arguments);this._startupChild(a)},_startupChild:function(a){a.set("tabIndex","-1")},_getFirst:function(){var a=this.getChildren();return a.length?a[0]:null},_getLast:function(){var a=this.getChildren();return a.length?
a[a.length-1]:null},focusNext:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,1))},focusPrev:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,-1),!0)},childSelector:function(a){return(a=n.byNode(a))&&a.getParent()==this}})})},"dijit/MenuItem":function(){define("dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/_base/kernel dojo/sniff dojo/_base/lang ./_Widget ./_TemplatedMixin ./_Contained ./_CssStateMixin dojo/text!./templates/MenuItem.html".split(" "),
function(l,m,c,f,b,h,n,e,a,q,p,u){n=l("dijit.MenuItem"+(h("dojo-bidi")?"_NoBidi":""),[e,a,q,p],{templateString:u,baseClass:"dijitMenuItem",label:"",_setLabelAttr:function(a){this._set("label",a);var b="",c;c=a.search(/{\S}/);if(0<=c){var b=a.charAt(c+1),k=a.substr(0,c);a=a.substr(c+3);c=k+b+a;a=k+'\x3cspan class\x3d"dijitMenuItemShortcutKey"\x3e'+b+"\x3c/span\x3e"+a}else c=a;this.domNode.setAttribute("aria-label",c+" "+this.accelKey);this.containerNode.innerHTML=a;this._set("shortcutKey",b)},iconClass:"dijitNoIcon",
_setIconClassAttr:{node:"iconNode",type:"class"},accelKey:"",disabled:!1,_fillContent:function(a){a&&!("label"in this.params)&&this._set("label",a.innerHTML)},buildRendering:function(){this.inherited(arguments);c.set(this.containerNode,"id",this.id+"_text");this.accelKeyNode&&c.set(this.accelKeyNode,"id",this.id+"_accel");m.setSelectable(this.domNode,!1)},onClick:function(){},focus:function(){try{8==h("ie")&&this.containerNode.focus(),this.focusNode.focus()}catch(a){}},_setSelected:function(a){f.toggle(this.domNode,
"dijitMenuItemSelected",a)},setLabel:function(a){b.deprecated("dijit.MenuItem.setLabel() is deprecated.  Use set('label', ...) instead.","","2.0");this.set("label",a)},setDisabled:function(a){b.deprecated("dijit.Menu.setDisabled() is deprecated.  Use set('disabled', bool) instead.","","2.0");this.set("disabled",a)},_setDisabledAttr:function(a){this.focusNode.setAttribute("aria-disabled",a?"true":"false");this._set("disabled",a)},_setAccelKeyAttr:function(a){this.accelKeyNode&&(this.accelKeyNode.style.display=
a?"":"none",this.accelKeyNode.innerHTML=a,c.set(this.containerNode,"colSpan",a?"1":"2"));this._set("accelKey",a)}});h("dojo-bidi")&&(n=l("dijit.MenuItem",n,{_setLabelAttr:function(a){this.inherited(arguments);"auto"===this.textDir&&this.applyTextDir(this.textDirNode)}}));return n})},"esri/tasks/LengthsParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel".split(" "),function(l,m,c,f,b,h){l=l(null,{declaredClass:"esri.tasks.LengthsParameters",
polylines:null,lengthUnit:null,geodesic:null,calculationType:null,toJson:function(){var b=c.map(this.polylines,function(a){return a.toJson()}),e={};e.polylines=f.toJson(b);b=this.polylines[0].spatialReference;e.sr=b.wkid?b.wkid:f.toJson(b.toJson());this.lengthUnit&&(e.lengthUnit=this.lengthUnit);this.geodesic&&(e.geodesic=this.geodesic);this.calculationType&&(e.calculationType=this.calculationType);return e}});b("extend-esri")&&m.setObject("tasks.LengthsParameters",l,h);return l})},"esri/tasks/AreasAndLengthsParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel".split(" "),
function(l,m,c,f,b,h){l=l(null,{declaredClass:"esri.tasks.AreasAndLengthsParameters",polygons:null,lengthUnit:null,areaUnit:null,calculationType:null,toJson:function(){var b=c.map(this.polygons,function(a){return a.toJson()}),e={};e.polygons=f.toJson(b);b=this.polygons[0].spatialReference;e.sr=b.wkid?b.wkid:f.toJson(b.toJson());this.lengthUnit&&(e.lengthUnit=this.lengthUnit);this.areaUnit&&(m.isString(this.areaUnit)?e.areaUnit=f.toJson({areaUnit:this.areaUnit}):e.areaUnit=this.areaUnit);this.calculationType&&
(e.calculationType=this.calculationType);return e}});b("extend-esri")&&m.setObject("tasks.AreasAndLengthsParameters",l,h);return l})},"dijit/DropDownMenu":function(){define(["dojo/_base/declare","dojo/keys","dojo/text!./templates/Menu.html","./_MenuBase"],function(l,m,c,f){return l("dijit.DropDownMenu",f,{templateString:c,baseClass:"dijitMenu",_onUpArrow:function(){this.focusPrev()},_onDownArrow:function(){this.focusNext()},_onRightArrow:function(b){this._moveToPopup(b);b.stopPropagation();b.preventDefault()},
_onLeftArrow:function(b){if(this.parentMenu)if(this.parentMenu._isMenuBar)this.parentMenu.focusPrev();else this.onCancel(!1);else b.stopPropagation(),b.preventDefault()}})})},"dijit/_Contained":function(){define(["dojo/_base/declare","./registry"],function(l,m){return l("dijit._Contained",null,{_getSibling:function(c){var f=this.domNode;do f=f[c+"Sibling"];while(f&&1!=f.nodeType);return f&&m.byNode(f)},getPreviousSibling:function(){return this._getSibling("previous")},getNextSibling:function(){return this._getSibling("next")},
getIndexInParent:function(){var c=this.getParent();return!c||!c.getIndexOfChild?-1:c.getIndexOfChild(this)}})})},"dijit/_KeyNavMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/on dijit/registry dijit/_FocusMixin".split(" "),function(l,m,c,f,b,h,n,e){return m("dijit._KeyNavMixin",e,{tabIndex:"0",childSelector:null,postCreate:function(){this.inherited(arguments);c.set(this.domNode,"tabIndex",this.tabIndex);if(!this._keyNavCodes){var a=this._keyNavCodes=
{};a[f.HOME]=b.hitch(this,"focusFirstChild");a[f.END]=b.hitch(this,"focusLastChild");a[this.isLeftToRight()?f.LEFT_ARROW:f.RIGHT_ARROW]=b.hitch(this,"_onLeftArrow");a[this.isLeftToRight()?f.RIGHT_ARROW:f.LEFT_ARROW]=b.hitch(this,"_onRightArrow");a[f.UP_ARROW]=b.hitch(this,"_onUpArrow");a[f.DOWN_ARROW]=b.hitch(this,"_onDownArrow")}var e=this,a="string"==typeof this.childSelector?this.childSelector:b.hitch(this,"childSelector");this.own(h(this.domNode,"keypress",b.hitch(this,"_onContainerKeypress")),
h(this.domNode,"keydown",b.hitch(this,"_onContainerKeydown")),h(this.domNode,"focus",b.hitch(this,"_onContainerFocus")),h(this.containerNode,h.selector(a,"focusin"),function(a){e._onChildFocus(n.getEnclosingWidget(this),a)}))},_onLeftArrow:function(){},_onRightArrow:function(){},_onUpArrow:function(){},_onDownArrow:function(){},focus:function(){this.focusFirstChild()},_getFirstFocusableChild:function(){return this._getNextFocusableChild(null,1)},_getLastFocusableChild:function(){return this._getNextFocusableChild(null,
-1)},focusFirstChild:function(){this.focusChild(this._getFirstFocusableChild())},focusLastChild:function(){this.focusChild(this._getLastFocusableChild())},focusChild:function(a,b){a&&(this.focusedChild&&a!==this.focusedChild&&this._onChildBlur(this.focusedChild),a.set("tabIndex",this.tabIndex),a.focus(b?"end":"start"))},_onContainerFocus:function(a){a.target!==this.domNode||this.focusedChild||this.focus()},_onFocus:function(){c.set(this.domNode,"tabIndex","-1");this.inherited(arguments)},_onBlur:function(a){c.set(this.domNode,
"tabIndex",this.tabIndex);this.focusedChild&&(this.focusedChild.set("tabIndex","-1"),this.lastFocusedChild=this.focusedChild,this._set("focusedChild",null));this.inherited(arguments)},_onChildFocus:function(a){a&&a!=this.focusedChild&&(this.focusedChild&&!this.focusedChild._destroyed&&this.focusedChild.set("tabIndex","-1"),a.set("tabIndex",this.tabIndex),this.lastFocused=a,this._set("focusedChild",a))},_searchString:"",multiCharSearchDuration:1E3,onKeyboardSearch:function(a,b,c,f){a&&this.focusChild(a)},
_keyboardSearchCompare:function(a,b){var c=a.domNode,c=(a.label||(c.focusNode?c.focusNode.label:"")||c.innerText||c.textContent||"").replace(/^\s+/,"").substr(0,b.length).toLowerCase();return b.length&&c==b?-1:0},_isFormElement:function(a){return"INPUT"===a.tagName||"TEXTAREA"===a.tagName||"SELECT"===a.tagName||"BUTTON"===a.tagName},_onContainerKeydown:function(a){if(!this._isFormElement(document.activeElement)){var b=this._keyNavCodes[a.keyCode];b?(b(a,this.focusedChild),a.stopPropagation(),a.preventDefault(),
this._searchString=""):a.keyCode==f.SPACE&&(this._searchTimer&&!a.ctrlKey&&!a.altKey&&!a.metaKey)&&(a.stopImmediatePropagation(),a.preventDefault(),this._keyboardSearch(a," "))}},_onContainerKeypress:function(a){if(!this._isFormElement(document.activeElement)&&!(a.charCode<=f.SPACE||a.ctrlKey||a.altKey||a.metaKey))a.preventDefault(),a.stopPropagation(),this._keyboardSearch(a,String.fromCharCode(a.charCode).toLowerCase())},_keyboardSearch:function(a,c){var f=null,e,h=0;b.hitch(this,function(){this._searchTimer&&
this._searchTimer.remove();this._searchString+=c;var a=/^(.)\1*$/.test(this._searchString)?1:this._searchString.length;e=this._searchString.substr(0,a);this._searchTimer=this.defer(function(){this._searchTimer=null;this._searchString=""},this.multiCharSearchDuration);var b=this.focusedChild||null;if(1==a||!b)if(b=this._getNextFocusableChild(b,1),!b)return;a=b;do{var k=this._keyboardSearchCompare(b,e);k&&0==h++&&(f=b);if(-1==k){h=-1;break}b=this._getNextFocusableChild(b,1)}while(b!=a)})();this.onKeyboardSearch(f,
a,e,h)},_onChildBlur:function(){},_getNextFocusableChild:function(a,b){var c=a;do{if(a)a=this._getNext(a,b);else if(a=this[0<b?"_getFirst":"_getLast"](),!a)break;if(null!=a&&a!=c&&a.isFocusable())return a}while(a!=c);return null},_getFirst:function(){return null},_getLast:function(){return null},_getNext:function(a,b){if(a)for(a=a.domNode;a;)if((a=a[0>b?"previousSibling":"nextSibling"])&&"getAttribute"in a){var c=n.byNode(a);if(c)return c}return null}})})},"dijit/Menu":function(){define("require dojo/_base/array dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/_base/window dojo/window ./popup ./DropDownMenu dojo/ready".split(" "),
function(l,m,c,f,b,h,n,e,a,q,p,u,z,g,v,k){p("dijit-legacy-requires")&&k(0,function(){l(["dijit/MenuItem","dijit/PopupMenuItem","dijit/CheckedMenuItem","dijit/MenuSeparator"])});return c("dijit.Menu",v,{constructor:function(){this._bindings=[]},targetNodeIds:[],selector:"",contextMenuForWindow:!1,leftClickToOpen:!1,refocus:!0,postCreate:function(){this.contextMenuForWindow?this.bindDomNode(this.ownerDocumentBody):m.forEach(this.targetNodeIds,this.bindDomNode,this);this.inherited(arguments)},_iframeContentWindow:function(a){return z.get(this._iframeContentDocument(a))||
this._iframeContentDocument(a).__parent__||a.name&&document.frames[a.name]||null},_iframeContentDocument:function(a){return a.contentDocument||a.contentWindow&&a.contentWindow.document||a.name&&document.frames[a.name]&&document.frames[a.name].document||null},bindDomNode:function(k){k=f.byId(k,this.ownerDocument);var c;if("iframe"==k.tagName.toLowerCase()){var g=k;c=this._iframeContentWindow(g);c=u.body(c.document)}else c=k==u.body(this.ownerDocument)?this.ownerDocument.documentElement:k;var h={node:k,
iframe:g};b.set(k,"_dijitMenu"+this.id,this._bindings.push(h));var l=a.hitch(this,function(a){var b=this.selector,k=b?function(a){return q.selector(b,a)}:function(a){return a},c=this;return[q(a,k(this.leftClickToOpen?"click":"contextmenu"),function(a){a.stopPropagation();a.preventDefault();(new Date).getTime()<this._lastKeyDown+500||c._scheduleOpen(this,g,{x:a.pageX,y:a.pageY},a.target)}),q(a,k("keydown"),function(a){if(93==a.keyCode||a.shiftKey&&a.keyCode==e.F10||this.leftClickToOpen&&a.keyCode==
e.SPACE)a.stopPropagation(),a.preventDefault(),c._scheduleOpen(this,g,null,a.target),this._lastKeyDown=(new Date).getTime()})]});h.connects=c?l(c):[];g&&(h.onloadHandler=a.hitch(this,function(){var a=this._iframeContentWindow(g),a=u.body(a.document);h.connects=l(a)}),g.addEventListener?g.addEventListener("load",h.onloadHandler,!1):g.attachEvent("onload",h.onloadHandler))},unBindDomNode:function(a){var k;try{k=f.byId(a,this.ownerDocument)}catch(c){return}a="_dijitMenu"+this.id;if(k&&b.has(k,a)){for(var g=
b.get(k,a)-1,e=this._bindings[g],h;h=e.connects.pop();)h.remove();(h=e.iframe)&&(h.removeEventListener?h.removeEventListener("load",e.onloadHandler,!1):h.detachEvent("onload",e.onloadHandler));b.remove(k,a);delete this._bindings[g]}},_scheduleOpen:function(a,b,k,c){this._openTimer||(this._openTimer=this.defer(function(){delete this._openTimer;this._openMyself({target:c,delegatedTarget:a,iframe:b,coords:k})},1))},_openMyself:function(a){function b(){u.refocus&&r&&r.focus();g.close(u)}var k=a.target,
c=a.iframe,e=a.coords,l=!e;this.currentTarget=a.delegatedTarget;if(e){if(c){a=h.position(c,!0);var k=this._iframeContentWindow(c),k=h.docScroll(k.document),m=n.getComputedStyle(c),q=n.toPixelValue,t=(p("ie")&&p("quirks")?0:q(c,m.paddingLeft))+(p("ie")&&p("quirks")?q(c,m.borderLeftWidth):0),c=(p("ie")&&p("quirks")?0:q(c,m.paddingTop))+(p("ie")&&p("quirks")?q(c,m.borderTopWidth):0);e.x+=a.x+t-k.x;e.y+=a.y+c-k.y}}else e=h.position(k,!0),e.x+=10,e.y+=10;var u=this,c=this._focusManager.get("prevNode");
a=this._focusManager.get("curNode");var r=!a||f.isDescendant(a,this.domNode)?c:a;g.open({popup:this,x:e.x,y:e.y,onExecute:b,onCancel:b,orient:this.isLeftToRight()?"L":"R"});this.focus();l||this.defer(function(){this._cleanUp(!0)});this._onBlur=function(){this.inherited("_onBlur",arguments);g.close(this)}},destroy:function(){m.forEach(this._bindings,function(a){a&&this.unBindDomNode(a.node)},this);this.inherited(arguments)}})})},"dijit/_MenuBase":function(){define("dojo/_base/array dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/_base/lang dojo/mouse dojo/on dojo/window ./a11yclick ./registry ./_Widget ./_CssStateMixin ./_KeyNavContainer ./_TemplatedMixin".split(" "),
function(l,m,c,f,b,h,n,e,a,q,p,u,z,g,v){return m("dijit._MenuBase",[u,v,g,z],{selected:null,_setSelectedAttr:function(a){this.selected!=a&&(this.selected&&(this.selected._setSelected(!1),this._onChildDeselect(this.selected)),a&&a._setSelected(!0),this._set("selected",a))},activated:!1,_setActivatedAttr:function(a){b.toggle(this.domNode,"dijitMenuActive",a);b.toggle(this.domNode,"dijitMenuPassive",!a);this._set("activated",a)},parentMenu:null,popupDelay:500,passivePopupDelay:Infinity,autoFocus:!1,
childSelector:function(a){var b=p.byNode(a);return a.parentNode==this.containerNode&&b&&b.focus},postCreate:function(){var a=this,b="string"==typeof this.childSelector?this.childSelector:h.hitch(this,"childSelector");this.own(e(this.containerNode,e.selector(b,n.enter),function(){a.onItemHover(p.byNode(this))}),e(this.containerNode,e.selector(b,n.leave),function(){a.onItemUnhover(p.byNode(this))}),e(this.containerNode,e.selector(b,q),function(b){a.onItemClick(p.byNode(this),b);b.stopPropagation()}),
e(this.containerNode,e.selector(b,"focusin"),function(){a._onItemFocus(p.byNode(this))}));this.inherited(arguments)},onKeyboardSearch:function(a,b,c,e){this.inherited(arguments);if(a&&(-1==e||a.popup&&1==e))this.onItemClick(a,b)},_keyboardSearchCompare:function(a,b){return a.shortcutKey?b==a.shortcutKey.toLowerCase()?-1:0:this.inherited(arguments)?1:0},onExecute:function(){},onCancel:function(){},_moveToPopup:function(a){if(this.focusedChild&&this.focusedChild.popup&&!this.focusedChild.disabled)this.onItemClick(this.focusedChild,
a);else(a=this._getTopMenu())&&a._isMenuBar&&a.focusNext()},_onPopupHover:function(){this.set("selected",this.currentPopupItem);this._stopPendingCloseTimer()},onItemHover:function(a){this.activated?(this.set("selected",a),a.popup&&(!a.disabled&&!this.hover_timer)&&(this.hover_timer=this.defer(function(){this._openItemPopup(a)},this.popupDelay))):Infinity>this.passivePopupDelay&&(this.passive_hover_timer&&this.passive_hover_timer.remove(),this.passive_hover_timer=this.defer(function(){this.onItemClick(a,
{type:"click"})},this.passivePopupDelay));this._hoveredChild=a;a._set("hovering",!0)},_onChildDeselect:function(a){this._stopPopupTimer();this.currentPopupItem==a&&(this._stopPendingCloseTimer(),this._pendingClose_timer=this.defer(function(){this.currentPopupItem=this._pendingClose_timer=null;a._closePopup()},this.popupDelay))},onItemUnhover:function(a){this._hoveredChild==a&&(this._hoveredChild=null);this.passive_hover_timer&&(this.passive_hover_timer.remove(),this.passive_hover_timer=null);a._set("hovering",
!1)},_stopPopupTimer:function(){this.hover_timer&&(this.hover_timer=this.hover_timer.remove())},_stopPendingCloseTimer:function(){this._pendingClose_timer&&(this._pendingClose_timer=this._pendingClose_timer.remove())},_getTopMenu:function(){for(var a=this;a.parentMenu;a=a.parentMenu);return a},onItemClick:function(a,b){this.passive_hover_timer&&this.passive_hover_timer.remove();this.focusChild(a);if(a.disabled)return!1;if(a.popup){this.set("selected",a);this.set("activated",!0);var c=/^key/.test(b._origType||
b.type)||0==b.clientX&&0==b.clientY;this._openItemPopup(a,c)}else this.onExecute(),a._onClick?a._onClick(b):a.onClick(b)},_openItemPopup:function(a,b){if(a!=this.currentPopupItem){this.currentPopupItem&&(this._stopPendingCloseTimer(),this.currentPopupItem._closePopup());this._stopPopupTimer();var c=a.popup;c.parentMenu=this;this.own(this._mouseoverHandle=e.once(c.domNode,"mouseover",h.hitch(this,"_onPopupHover")));var f=this;a._openPopup({parent:this,orient:this._orient||["after","before"],onCancel:function(){b&&
f.focusChild(a);f._cleanUp()},onExecute:h.hitch(this,"_cleanUp",!0),onClose:function(){f._mouseoverHandle&&(f._mouseoverHandle.remove(),delete f._mouseoverHandle)}},b);this.currentPopupItem=a}},onOpen:function(){this.isShowingNow=!0;this.set("activated",!0)},onClose:function(){this.set("activated",!1);this.set("selected",null);this.isShowingNow=!1;this.parentMenu=null},_closeChild:function(){this._stopPopupTimer();this.currentPopupItem&&(this.focused&&(f.set(this.selected.focusNode,"tabIndex",this.tabIndex),
this.selected.focusNode.focus()),this.currentPopupItem._closePopup(),this.currentPopupItem=null)},_onItemFocus:function(a){if(this._hoveredChild&&this._hoveredChild!=a)this.onItemUnhover(this._hoveredChild);this.set("selected",a)},_onBlur:function(){this._cleanUp(!0);this.inherited(arguments)},_cleanUp:function(a){this._closeChild();"undefined"==typeof this.isShowingNow&&this.set("activated",!1);a&&this.set("selected",null)}})})},"url:dijit/templates/Menu.html":'\x3ctable class\x3d"dijit dijitMenu dijitMenuPassive dijitReset dijitMenuTable" role\x3d"menu" tabIndex\x3d"${tabIndex}"\n\t   cellspacing\x3d"0"\x3e\n\t\x3ctbody class\x3d"dijitReset" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/tbody\x3e\n\x3c/table\x3e\n',
"url:dijit/templates/MenuItem.html":'\x3ctr class\x3d"dijitReset" data-dojo-attach-point\x3d"focusNode" role\x3d"menuitem" tabIndex\x3d"-1"\x3e\n\t\x3ctd class\x3d"dijitReset dijitMenuItemIconCell" role\x3d"presentation"\x3e\n\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitMenuItemIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\n\t\x3c/td\x3e\n\t\x3ctd class\x3d"dijitReset dijitMenuItemLabel" colspan\x3d"2" data-dojo-attach-point\x3d"containerNode,textDirNode"\n\t\trole\x3d"presentation"\x3e\x3c/td\x3e\n\t\x3ctd class\x3d"dijitReset dijitMenuItemAccelKey" style\x3d"display: none" data-dojo-attach-point\x3d"accelKeyNode"\x3e\x3c/td\x3e\n\t\x3ctd class\x3d"dijitReset dijitMenuArrowCell" role\x3d"presentation"\x3e\n\t\t\x3cspan data-dojo-attach-point\x3d"arrowWrapper" style\x3d"visibility: hidden"\x3e\n\t\t\t\x3cspan class\x3d"dijitInline dijitIcon dijitMenuExpand"\x3e\x3c/span\x3e\n\t\t\t\x3cspan class\x3d"dijitMenuExpandA11y"\x3e+\x3c/span\x3e\n\t\t\x3c/span\x3e\n\t\x3c/td\x3e\n\x3c/tr\x3e\n',
"url:esri/dijit/templates/Measurement.html":"\x3cdiv class\x3d\"esriMeasurement\"\x3e\n  \x3cdiv dojoType\x3d'dijit.layout.ContentPane' dojoAttachPoint\x3d'buttonPane' class\x3d'esriMeasurementButtonPane'\x3e\n    \x3cdiv dojoType\x3d'dijit.form.ToggleButton' baseClass\x3d'esriButton' dojoAttachPoint\x3d'area' checked\x3d'false' iconClass\x3d'areaIcon' showLabel\x3d'false' dojoAttachEvent\x3d'onClick:areaToggleButton'\x3e\x3c/div\x3e\n    \x3cdiv dojoType\x3d'dijit.form.ToggleButton' baseClass\x3d'esriButton' dojoAttachPoint\x3d'distance' iconClass\x3d'distanceIcon' showLabel\x3d'false' dojoAttachEvent\x3d'onClick:distanceToggleButton'\x3e\x3c/div\x3e\n    \x3cdiv dojoType\x3d'dijit.form.ToggleButton' baseClass\x3d'esriButton' dojoAttachPoint\x3d'location' iconClass\x3d'locationIcon' showLabel\x3d'false' dojoAttachEvent\x3d'onClick:locationToggleButton'\x3e\x3c/div\x3e\n    \x3cdiv class\x3d\"esriMeasurementSeparator\"\x3e|\x3c/div\x3e\n    \x3cbutton dojoType\x3d'dijit.form.DropDownButton' baseClass\x3d'esriToggleButton' dojoAttachPoint\x3d'unit' label\x3d'unit' value\x3d'unit' style\x3d'visibility:hidden;'\x3e\x3c/button\x3e\n  \x3c/div\x3e\n  \x3cdiv dojoType\x3d'dijit.layout.ContentPane' dojoAttachPoint\x3d'resultLabel' class\x3d'resultLabel esriMeasurementResultLabel'\x3e\x3c/div\x3e\n  \x3cdiv dojoType\x3d'dijit.layout.ContentPane' dojoAttachPoint\x3d'resultValue' align\x3d'leading' class\x3d'result esriMeasurementResultValue'\x3e\x26nbsp\x3c/div\x3e\n  \x3cdiv dojoType\x3d'dijit.layout.ContentPane' dojoAttachPoint\x3d'resultTable' align\x3d'leading' class\x3d\"resultTable esriMeasurementTableContainer\" style\x3d\"display:none;\"\x3e\n    \x3ctable class\x3d\"esriMeasurementResultTable\"\x3e\n      \x3ctr\x3e\n        \x3ctd class\x3d\"esriMeasurementTableHeader\" colspan\x3d\"2\"\x3e${NLS_Lon}\x3c/td\x3e\x3ctd class\x3d\"esriMeasurementTableHeader\"\x3e${NLS_Lat}\x3c/td\x3e\n      \x3c/tr\x3e\n      \x3ctr class\x3d\"esriMeasurementTableRow\"\x3e\n        \x3ctd dojoAttachPoint\x3d\"mouseCell\"\x3e\x3c/td\x3e\n        \x3ctd class\x3d\"esriMeasurementTableCell\"\x3e\n          \x3cspan dojoAttachPoint\x3d\"mouseLongitude\" dir\x3d'ltr'\x3e\x3c/span\x3e\n        \x3c/td\x3e\n        \x3ctd class\x3d\"esriMeasurementTableCell\"\x3e\n          \x3cspan dojoAttachPoint\x3d\"mouseLatitude\" dir\x3d'ltr'\x3e\x3c/span\x3e\n        \x3c/td\x3e\n      \x3c/tr\x3e\n      \x3ctr class\x3d\"esriMeasurementTableRow\"\x3e\n        \x3ctd dojoAttachPoint\x3d\"pinCell\"\x3e\x3c/td\x3e\n        \x3ctd class\x3d\"esriMeasurementTableCell\"\x3e\n          \x3cspan dojoAttachPoint\x3d\"markerLongitude\" dir\x3d'ltr'\x3e\x3c/span\x3e\n        \x3c/td\x3e\n        \x3ctd class\x3d\"esriMeasurementTableCell\"\x3e\n          \x3cspan dojoAttachPoint\x3d\"markerLatitude\" dir\x3d'ltr'\x3e\x3c/span\x3e\n        \x3c/td\x3e\n      \x3c/tr\x3e\n    \x3c/table\x3e\n  \x3c/div\x3e\n\x3c/div\x3e",
"*noref":1}});
define("esri/dijit/Measurement","require dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/Color dojo/sniff dojo/number dojo/dom-style dojo/dom-construct dojox/gfx dijit/_Widget dijit/_Templated dijit/registry dijit/Menu dijit/MenuItem ../SpatialReference ../symbols/PictureMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleFillSymbol ../symbols/jsonUtils ../geometry/geodesicUtils ../geometry/webMercatorUtils ../geometry/Point ../geometry/Polyline ../geometry/Polygon ../graphic ../tasks/AreasAndLengthsParameters ../tasks/LengthsParameters ../tasks/GeometryService ../kernel ../config ../domUtils ../lang ../units ../WKIDUnitConversion ./_EventedWidget dojo/text!./templates/Measurement.html dojo/i18n!../nls/jsapi dijit/form/ToggleButton dijit/form/DropDownButton dijit/layout/ContentPane".split(" "),function(l,
m,c,f,b,h,n,e,a,q,p,u,z,g,v,k,E,H,A,I,J,C,w,F,t,D,r,K,L,M,N,O,x,P,y,Q,R,S,s){m=m([R,u,z],{declaredClass:"esri.dijit.Measurement",widgetsInTemplate:!0,templateString:S,unitDictionary:[],result:null,inputPoints:[],measureGraphics:[],currentPoint:null,numberPattern:"#,###,###,##0.0",_eventMap:{"measure-start":["toolName","unitName"],measure:["toolName","geometry","values","unitName"],"measure-end":["toolName","geometry","values","unitName"],"tool-change":["toolName","unitName"],"unit-change":["unitName",
"toolName"]},constructor:function(d,a){d=d||{};if(d.map){this._map=d.map;if(this._map.loaded)this._map.cs=this._checkCS(this._map.spatialReference),this._interpolatedMap=!("Web Mercator"===this._map.cs||"PCS"===this._map.cs);else var G=b.connect(this._map,"onLoad",this,function(){b.disconnect(G);G=null;this._map.cs=this._checkCS(this._map.spatialReference);this._interpolatedMap=!("Web Mercator"===this._map.cs||"PCS"===this._map.cs)});this._geometryService=O.defaults.geometryService;this._mouseImgURL=
l.toUrl("./images/cursor16x24.png");this._defaultPinURL=l.toUrl("./images/esriGreenPin16x26.png");this._defaultLineSymbol=new A(A.STYLE_SOLID,new h([0,128,255]),3);this._defaultFillSymbol=new I(A.STYLE_SOLID,new A(A.STYLE_SOLID,new h([0,128,255]),3),new h([0,0,0,0.5]));d.pointSymbol?(this._pointSymbol=d.pointSymbol,this._useDefaultPointSymbol=!1):(this._pointSymbol=new H(this._defaultPinURL,16,26),this._pointSymbol.setOffset(0,12),this._useDefaultPointSymbol=!0);var e=d.fillSymbol||this._defaultFillSymbol;
this._fillSymbol=e;this._areaLineSymbol=e.outline||this._defaultLineSymbol;this._borderlessFillSymbol=J.fromJson(e.toJson());this._borderlessFillSymbol.setOutline(null);this._lineSymbol=d.lineSymbol?d.lineSymbol:this._defaultLineSymbol;this._defaultLengthUnit=d.defaultLengthUnit?d.defaultLengthUnit:y.MILES;this._defaultAreaUnit=d.defaultAreaUnit?d.defaultAreaUnit:y.ACRES;this._defaultLocationUnit=d.defaultLocationUnit?d.defaultLocationUnit:y.DECIMAL_DEGREES;this._snappingCallback=c.hitch(this,this._snappingCallback);
d.geometry&&(this._userGeometry=d.geometry);this._calcTimer=null;this.advancedLocationUnits=d.advancedLocationUnits||!1;this.NLS_Lon=s.widgets.measurement.NLS_longitude;this.NLS_Lat=s.widgets.measurement.NLS_latitude;this._gsErrorMsg=s.widgets.measurement.NLS_geometry_service_error;this._calculatingMsg=s.widgets.measurement.NLS_calculating}else console.log("dijit.MeasureTool: unable to find the 'map' property in parameters")},startup:function(){var d=s.widgets.measurement;this.unitDictionary[d.NLS_length_miles]=
1;this.unitDictionary[d.NLS_length_kilometers]=1.609344;this.unitDictionary[d.NLS_length_feet]=5280;this.unitDictionary[d.NLS_length_meters]=1609.34;this.unitDictionary[d.NLS_length_yards]=1760;this.unitDictionary[d.NLS_length_nautical_miles]=0.869;this.unitDictionary[d.NLS_area_acres]=1;this.unitDictionary[d.NLS_area_sq_kilometers]=0.004047;this.unitDictionary[d.NLS_area_sq_miles]=0.0015625;this.unitDictionary[d.NLS_area_sq_feet]=43560;this.unitDictionary[d.NLS_area_sq_meters]=4046.87;this.unitDictionary[d.NLS_area_hectares]=
0.4047;this.unitDictionary[d.NLS_area_sq_yards]=4840;this.unitDictionary[d.NLS_area_sq_nautical_miles]=0.001179874545293396;this.units={esriMiles:d.NLS_length_miles,esriKilometers:d.NLS_length_kilometers,esriFeet:d.NLS_length_feet,esriMeters:d.NLS_length_meters,esriYards:d.NLS_length_yards,esriNauticalMiles:d.NLS_length_nautical_miles,esriAcres:d.NLS_area_acres,esriSquareKilometers:d.NLS_area_sq_kilometers,esriSquareMiles:d.NLS_area_sq_miles,esriSquareFeet:d.NLS_area_sq_feet,esriSquareMeters:d.NLS_area_sq_meters,
esriHectares:d.NLS_area_hectares,esriSquareYards:d.NLS_area_sq_yards,esriSquareNauticalMiles:d.NLS_area_sq_nautical_miles,esriDecimalDegrees:d.NLS_decimal_degrees,esriDegreeMinuteSeconds:d.NLS_deg_min_sec,esriMGRS:d.NLS_MGRS,esriUSNG:d.NLS_USNG,esriUTM:d.NLS_UTM,esriDDM:d.NLS_DDM,esriDD:d.NLS_DD,esriGARS:d.NLS_GARS,esriGeoRef:d.NLS_GeoRef};g.byNode(this.distance.domNode).setLabel(s.widgets.measurement.NLS_distance);g.byNode(this.area.domNode).setLabel(s.widgets.measurement.NLS_area);g.byNode(this.location.domNode).setLabel(s.widgets.measurement.NLS_location);
g.byNode(this.resultLabel.domNode).setContent(s.widgets.measurement.NLS_resultLabel);q.create("img",{src:this._mouseImgURL,style:"vertical-align:middle"},this.mouseCell);this._useDefaultPointSymbol?q.create("img",{src:this._defaultPinURL,style:"vertical-align:middle"},this.pinCell):this._drawPointGraphic();if(this._userGeometry)if(this._map.loaded)this._measureCustomGeometry();else var a=b.connect(this._map,"onLoad",this,function(){b.disconnect(a);a=null;this._measureCustomGeometry()})},measureArea:function(){this._map.navigationManager.setImmediateClick(!0);
this.inputPoints=[];this._createAreaUnitList();this.tempGraphic=new r;this.tempGraphic.setSymbol(this._areaLineSymbol);this.tempGraphic.setGeometry(new t(this._map.spatialReference));this._map.graphics.add(this.tempGraphic);"PCS"===this._map.cs&&(this._geometryAreaHandler=b.connect(this._geometryService,"onAreasAndLengthsComplete",this,"_outputArea"));this.mouseClickMapHandler=b.connect(this._map,"onClick",this,"_measureAreaMouseClickHandler");this.doubleClickMapHandler=b.connect(this._map,"onDblClick",
this,"_measureAreaDblClickHandler")},measureDistance:function(){this._map.navigationManager.setImmediateClick(!0);"PCS"===this._map.cs&&(this._projectMapExtent(this._map.extent),this._mapExtentChangeHandler=b.connect(this._map,"onExtentChange",this,"_projectMapExtent"));this.inputPoints=[];this._createLengthUnitList();this.mouseClickMapHandler=b.connect(this._map,"onClick",this,"_measureDistanceMouseClickHandler");this.doubleClickMapHandler=b.connect(this._map,"onDblClick",this,"_measureDistanceDblClickHandler")},
measureLocation:function(){this._map.navigationManager.setImmediateClick(!0);this.measureGraphics=[];this._map.graphics.remove(this.locationGraphic);this._createLocationUnitList();"PCS"===this._map.cs&&(this._projectMapExtent(this._map.extent),this._mapExtentChangeHandler=b.connect(this._map,"onExtentChange",c.hitch(this,this._projectMapExtent)));this._clickMapHandler=b.connect(this._map,"onClick",this,"_measureLocationClickHandler");this.mouseMoveMapHandler=b.connect(this._map,"onMouseMove",this,
"_showCoordinates");this.mouseDragMapHandler=b.connect(this._map,"onMouseDrag",c.hitch(this,function(){g.byNode(this.resultValue.domNode).set("disabled",!0)}))},setTool:function(d,B){this._previousTool=this.activeTool;this._polylineGraphics=[];this.polylinePaths=[];this.closeTool();this.markerLocationY=this.markerLocationX=this.mouseLocationY=this.mouseLocationX=null;this.polygonGraphic&&(this._map.graphics.remove(this.polygonGraphic),this.polygonGraphic=null);var b=g.byNode(this[d].domNode).checked;
a.set(this.unit.domNode,"visibility","visible");g.byNode(this.area.domNode).set("checked",!1);g.byNode(this.distance.domNode).set("checked",!1);g.byNode(this.location.domNode).set("checked",!1);if(!0===B||!1===B)b=B;g.byNode(this[d].domNode).set("checked",b);this._toggleStaticLocationTable(!1,!0);b?(this.activeTool=d,(this._dblClickZoom=this._map.isDoubleClickZoom)&&this._map.disableDoubleClickZoom(),"area"===d?this.measureArea():"distance"===d?this.measureDistance():"location"===d&&this.measureLocation(),
this._map.snappingManager&&(this._map.snappingManager._startSelectionLayerQuery(),this._map.snappingManager._setUpSnapping())):(this.activeTool="",a.set(this.unit.domNode,"visibility","hidden"))},areaToggleButton:function(){this.clearResult();this.setTool("area")},distanceToggleButton:function(){this.clearResult();this.setTool("distance")},locationToggleButton:function(){this.clearResult();this.setTool("location")},closeTool:function(){var d=this._map;d.navigationManager.setImmediateClick(!1);this._dblClickZoom&&
d.enableDoubleClickZoom();this.inputPoints=[];d.snappingManager&&d.snappingManager._snappingGraphic&&d.graphics.remove(d.snappingManager._snappingGraphic);b.disconnect(this.mouseClickMapHandler);b.disconnect(this.mouseMoveMapHandler);b.disconnect(this.doubleClickMapHandler);b.disconnect(this.mouseDragMapHandler);b.disconnect(this._clickMapHandler);b.disconnect(this._mapExtentChangeHandler);b.disconnect(this._geometryAreaHandler);this.mouseClickMapHandler=this.mouseMoveMapHandler=this.doubleClickMapHandler=
this.mouseDragMapHandler=this._clickMapHandler=this._mapExtentChangeHandler=this._geometryAreaHandler=null;this._map.snappingManager&&(this._map.snappingManager._stopSelectionLayerQuery(),this._map.snappingManager._killOffSnapping());this.unit._opened&&this.unit.closeDropDown()},clearResult:function(){var d=this._map;this.result=0;g.byNode(this.resultValue.domNode).set("content","\x26nbsp");var a;for(a=0;a<this.measureGraphics.length;a++)d.graphics.remove(this.measureGraphics[a]);this.measureGraphic=
null;this.measureGraphics=[];d.graphics.remove(this.tempGraphic);b.disconnect(this.mouseMoveMapHandler);this.mouseMoveMapHandler=null},show:function(){x.show(this.domNode)},hide:function(){x.hide(this.domNode)},showTool:function(d){this[d].domNode.style.display="inline"},hideTool:function(d){this[d].domNode.style.display="none"},getTool:function(){if(this.activeTool)return{toolName:this.activeTool,unitName:this.getUnit()}},getUnit:function(){if("unit"!==this.unit.label)return this.unit.label},destroy:function(){this.closeTool();
this.clearResult();this.inherited(arguments);this._map=this._geometryService=this.measureGraphics=this.measureGraphic=this.tempGraphic=null},resize:function(){},onToolChange:function(){},onUnitChange:function(){},onMeasureStart:function(){},onMeasure:function(){},onMeasureEnd:function(){},measure:function(d){d&&(this._userGeometry=d,this._measureCustomGeometry())},_measureCustomGeometry:function(){this.clearResult();switch(this._userGeometry.type){case "point":this._measureCustomPoint();break;case "polyline":this._measureCustomDistance();
break;case "polygon":this._measureCustomArea()}},_measureCustomPoint:function(){this.setTool("location",!0);"Web Mercator"===this._map.cs&&this._userGeometry.spatialReference!==this._map.spatialReference&&(this._userGeometry=w.geographicToWebMercator(this._userGeometry));this.measureGraphic=new r;this.measureGraphic.setSymbol(this._pointSymbol);this.measureGraphic.setGeometry(this._userGeometry);this.measureGraphics.push(this.measureGraphic);this._map.graphics.add(this.measureGraphic);this._measurePoint(this._userGeometry)},
_measureCustomDistance:function(){1<this._userGeometry.paths[0].length&&(this.setTool("distance",!0),this.inputPoints=[],f.forEach(this._userGeometry.paths[0],c.hitch(this,function(d,a){this.inputPoints.push(d);var b=new r(new F(d[0],d[1],this._userGeometry.spatialReference),this._pointSymbol);this.measureGraphics.push(b);this._map.graphics.add(b);0!==a&&(this.result+=this._geodesicDistance(d,this._userGeometry.paths[0][a-1]))})),this.measureGraphic=new r,this.measureGraphic.setSymbol(this._lineSymbol),
this.measureGraphics.push(this.measureGraphic),this._userGeometry=this._densifyGeometry(this._userGeometry),this.measureGraphic.setGeometry(this._userGeometry),this._map.graphics.add(this.measureGraphic),this._showDistance(this.result),this.inputPoints=[],this.onMeasureEnd(this.activeTool,this._userGeometry,this.result,this.getUnit()))},_measureCustomArea:function(){this.setTool("area",!0);this.inputPoints=[];var d=this._densifyGeometry(this._userGeometry);this.measureGraphic=new r;this.measureGraphic.setGeometry(d);
this.measureGraphic.setSymbol(this._fillSymbol);this.measureGraphics.push(this.measureGraphic);this._map.graphics.add(this.measureGraphic);this._getArea(d);this.inputPoints=[]},_densifyGeometry:function(d){"Web Mercator"===this._map.cs&&(d=w.webMercatorToGeographic(d));d="PCS"===this._map.cs?d:C.geodesicDensify(d,5E5);"Web Mercator"===this._map.cs&&(d=w.geographicToWebMercator(d));return d},_measureAreaMouseClickHandler:function(d){var a;this._map.snappingManager&&(a=this._map.snappingManager._snappingPoint);
a=a||d.mapPoint;this.inputPoints.push(a);this._currentStartPt=a;if(1===this.inputPoints.length){this.tempGraphic.setGeometry(new t(this._map.spatialReference));for(d=0;d<this.measureGraphics.length;d++)this._map.graphics.remove(this.measureGraphics[d]);this.measureGraphics=[];this.result=0;this._outputResult(this.result,s.widgets.measurement.NLS_area_acres);this.mouseMoveMapHandler=b.connect(this._map,"onMouseMove",this,"_measureAreaMouseMoveHandler");this.onMeasureStart(this.activeTool,this.getUnit())}this.measureGraphic=
new r;this.measureGraphic.setSymbol(this._areaLineSymbol);this.measureGraphics.push(this.measureGraphic);if(1<this.inputPoints.length){var c=new t(this._map.spatialReference);c.addPath([this.inputPoints[this.inputPoints.length-2],a]);d=new t(this._map.spatialReference);d.addPath([this.inputPoints[0],a]);a=this._densifyGeometry(c);d=this._densifyGeometry(d);this.tempGraphic.setGeometry(d);this.measureGraphic.setGeometry(a);this._polylineGraphics.push(this.measureGraphic);this._map.graphics.add(this.measureGraphic);
if(2<this.inputPoints.length){a=new D(this._map.spatialReference);c=[];for(d=0;d<this.inputPoints.length;d++)c.push([this.inputPoints[d].x,this.inputPoints[d].y]);c.push([this.inputPoints[0].x,this.inputPoints[0].y]);a.addRing(c);this.polygonGraphic?(this._map.graphics.remove(this.polygonGraphic),this._polylineGraphics.push(this.tempGraphic),this.polygonGraphic=this._generatePolygonFromPaths(),this._map.graphics.add(this.polygonGraphic),this.measureGraphic=this.polygonGraphic,this._polylineGraphics.pop()):
(this.polygonGraphic=this._generatePolygonFromPaths(),this._map.graphics.add(this.polygonGraphic));this._getArea(a)}}else this.polygonGraphic&&(this._map.graphics.remove(this.polygonGraphic),this.polygonGraphic=null)},_measureAreaMouseMoveHandler:function(d){var a;if(0<this.inputPoints.length){var b=new t(this._map.spatialReference),c;this._map.snappingManager&&(c=this._map.snappingManager._snappingPoint);a=c||d.mapPoint;b.addPath([this._currentStartPt,a]);d=this._densifyGeometry(b);this.tempGraphic.setGeometry(d)}1<
this.inputPoints.length&&(d=new t(this._map.spatialReference),d.addPath([a,this.inputPoints[0]]),a=this._densifyGeometry(d),this.tempGraphic.setGeometry(this.tempGraphic.geometry.addPath(a.paths[0])))},_measureAreaDblClickHandler:function(d){b.disconnect(this.mouseMoveMapHandler);this.mouseMoveMapHandler=null;"touch"===this._map.navigationManager.eventModel&&n("ios")&&this._measureAreaMouseClickHandler(d);d=new D(this._map.spatialReference);var a=[],c;for(c=0;c<this.inputPoints.length;c++)a.push([this.inputPoints[c].x,
this.inputPoints[c].y]);a.push([this.inputPoints[0].x,this.inputPoints[0].y]);d.addRing(a);this.inputPoints=[];this.measureGeometry=this._densifyGeometry(d);this.polygonGraphic&&(this._map.graphics.remove(this.polygonGraphic),this._polylineGraphics.push(this.tempGraphic),this.polygonGraphic=this._generatePolygonFromPaths(),this._map.graphics.add(this.polygonGraphic));this._getArea(d);this._polylineGraphics=[];this.polylinePaths=[]},_generatePolygonFromPaths:function(){var d=[];f.forEach(this._polylineGraphics,
c.hitch(this,function(a){f.forEach(a.geometry.paths,c.hitch(this,function(a){f.forEach(a,c.hitch(this,function(a){d.push(a)}))}))}));d.push(d[0]);var a=new D(this._map.spatialReference);a.addRing(d);var a=this._densifyGeometry(a),b=new r;b.setGeometry(a);b.setSymbol(this._borderlessFillSymbol);this.measureGraphic=b;this.measureGraphics.push(b);return b},_getArea:function(d){var a=[],b=new K;b.areaUnit=M.UNIT_ACRES;b.calculationType="geodesic";D.prototype.isSelfIntersecting(d)?this._geometryService.simplify([d],
c.hitch(this,function(d){f.forEach(d,c.hitch(this,function(c){"PCS"===this._map.cs?(b.polygons=d,this._geometryService.areasAndLengths(b)):("Web Mercator"===this._map.cs&&(c=w.webMercatorToGeographic(c)),a.push(c))}));var e=C.geodesicAreas(a,y.ACRES);this._showArea(e[0])})):("Web Mercator"===this._map.cs&&(d=w.webMercatorToGeographic(d)),a.push(d),"PCS"===this._map.cs?(b.polygons=a,this._geometryService.areasAndLengths(b)):(d=C.geodesicAreas(a,y.ACRES),this._showArea(Math.abs(d[0]))))},_outputArea:function(d){this._showArea(Math.abs(d.areas[0]))},
_showArea:function(d){if(d)if(this.result=d,d=g.byNode(this.unit.domNode).label,d=this._outputResult(this.result,d),this.mouseMoveMapHandler)this.onMeasure(this.activeTool,this.measureGraphic.geometry,d,this.getUnit());else this.onMeasureEnd(this.activeTool,this.measureGraphic.geometry,d,this.getUnit())},_measureDistanceDblClickHandler:function(d){b.disconnect(this.mouseMoveMapHandler);this.mouseMoveMapHandler=null;"touch"===this._map.navigationManager.eventModel&&n("ios")&&this._measureDistanceMouseClickHandler(d);
var a=new t(this._map.spatialReference);a.addPath(this.inputPoints);a=this._densifyGeometry(a);"PCS"===this._map.cs&&(d=new L,d.polylines=[a],d.lengthUnit=9093,d.calculationType="geodesic",this._geometryService.lengths(d,c.hitch(this,function(d){this.result=d.lengths[0];this._showDistance(this.result);this.inputPoints=[];this.onMeasureEnd(this.activeTool,a,this.result,this.getUnit())})));this.inputPoints=[];this.result=this._outputResult(this.result,this.getUnit());this.onMeasureEnd(this.activeTool,
a,this.result,this.getUnit())},_measureDistanceMouseClickHandler:function(a){var c;this._map.snappingManager&&(c=this._map.snappingManager._snappingPoint);a=c||a.mapPoint;this.inputPoints.push(a);this._currentStartPt=a;if(1===this.inputPoints.length){for(c=0;c<this.measureGraphics.length;c++)this._map.graphics.remove(this.measureGraphics[c]);this._map.graphics.remove(this.tempGraphic);this.measureGraphics=[];this.result=0;this._outputResult(this.result,s.widgets.measurement.NLS_length_miles);this.tempGraphic=
new r;this.tempGraphic.setSymbol(this._lineSymbol);this._map.graphics.add(this.tempGraphic);this.mouseMoveMapHandler=b.connect(this._map,"onMouseMove",this,"_measureDistanceMouseMoveHandler");this.onMeasureStart(this.activeTool,this.getUnit())}this.tempGraphic.setGeometry(new t(this._map.spatialReference));this.flagGraphic=new r;this.flagGraphic.setSymbol(this._pointSymbol);this.flagGraphic.setGeometry(a);this.measureGraphics.push(this.flagGraphic);this._map.graphics.add(this.flagGraphic);1<this.inputPoints.length&&
(this.measureGraphic=new r,this.measureGraphic.setSymbol(this._lineSymbol),this.measureGraphics.push(this.measureGraphic),c=new t(this._map.spatialReference),c.addPath([this.inputPoints[this.inputPoints.length-2],a]),c=this._densifyGeometry(c),this.measureGraphic.setGeometry(c),this._map.graphics.add(this.measureGraphic),this.result+=this._geodesicDistance(this.inputPoints[this.inputPoints.length-2],a),this._showDistance(this.result),this.onMeasure(this.activeTool,a,this._outputResult(this.result,
this.getUnit()),this.getUnit()))},_measureDistanceMouseMoveHandler:function(a){if(0<this.inputPoints.length){var b=new t(this._map.spatialReference),c;this._map.snappingManager&&(c=this._map.snappingManager._snappingPoint);a=c||a.mapPoint;b.addPath([this._currentStartPt,a]);b=this._densifyGeometry(b);this.tempGraphic.setGeometry(b);b=this._geodesicDistance(this._currentStartPt,a);this._showDistance(b+this.result)}},_geodesicDistance:function(a,b){var c=new t(this._map.spatialReference);"PCS"===this._map.cs&&
(a=this._getGCSLocation(a),b=this._getGCSLocation(b));c.addPath([a,b]);"Web Mercator"===this._map.cs&&(c=w.webMercatorToGeographic(c));return C.geodesicLengths([c],y.MILES)[0]},_showDistance:function(a){a&&this._outputResult(a,g.byNode(this.unit.domNode).label)},_measureLocationClickHandler:function(a){var b;this._map.snappingManager&&(b=this._map.snappingManager._snappingPoint);a=b||a.mapPoint;this.locationToggleButton();this.locationGraphic=new r;this.locationGraphic.setGeometry(a);this.locationGraphic.setSymbol(this._pointSymbol);
this._map.graphics.add(this.locationGraphic);this.measureGraphics.push(this.locationGraphic);this._measurePoint(a)},_measurePoint:function(a){var b;if("esriDegreeMinuteSeconds"===this.currentLocationUnit||"esriDecimalDegrees"===this.currentLocationUnit)this._showStaticCoordinates({mapPoint:a});else if(this._interpolatedMap){var e=new E({wkid:4326});this._geometryService.project([a],e,c.hitch(this,function(a){b=a[0];this._showAdvancedStaticCoordinates(b)}))}else b=this._getGCSLocation(a),this._showAdvancedStaticCoordinates(b)},
_showAdvancedStaticCoordinates:function(a){this.markerLocationX=this.mouseLocationX=a.x;this.markerLocationY=this.mouseLocationY=a.y;this._toGeoCoordinateString({coordinates:[[this.markerLocationX,this.markerLocationY]],sr:{wkid:4326},conversionType:this.units[this.currentLocationUnit]},a)},_toGeoCoordinateString:function(a,b){this.resultValue.domNode.innerHTML="\x26nbsp";this._geometryService.toGeoCoordinateString(a,c.hitch(this,function(a){clearTimeout(this._calcTimer);a?(this.resultValue.domNode.innerHTML=
a,this.onMeasureEnd(this.activeTool,b,a,this.getUnit())):(this.resultValue.domNode.innerHTML=this._gsErrorMsg,this.onMeasureEnd(this.activeTool,null,null,this.getUnit()))}),c.hitch(this,function(a){this.resultValue.domNode.innerHTML=this._gsErrorMsg;this.onMeasureEnd(this.activeTool,null,null,this.getUnit())}));clearTimeout(this._calcTimer);this._calcTimer=setTimeout(c.hitch(this,function(){this.resultValue.domNode.innerHTML=this._calculatingMsg},1E3))},_getGCSLocation:function(a){if("Web Mercator"===
this._map.cs)a=w.webMercatorToGeographic(a);else if("PCS"===this._map.cs){if(this._map._newExtent){var b=Math.abs((this._map._newExtent.xmax-this._map._newExtent.xmin)/(this._map.extent.xmax-this._map.extent.xmin)),c=Math.abs((this._map._newExtent.ymax-this._map._newExtent.ymin)/(this._map.extent.ymax-this._map.extent.ymin));a=new F((a.x-this._map.extent.xmin)*b+this._map._newExtent.xmin,(a.y-this._map.extent.ymin)*c+this._map._newExtent.ymin,this._map.spatialReference)}}else a=a.normalize();return a},
_projectMapExtent:function(a){a=new r(a);var B=new E({wkid:4326});this._geometryService.project([a.geometry],B,c.hitch(this,function(a){!this.mouseMoveMapHandler&&"location"===this.activeTool&&(this.mouseMoveMapHandler=b.connect(this._map,"onMouseMove",c.hitch(this,this._showCoordinates)),this.mouseDragMapHandler=b.connect(this._map,"onMouseDrag",c.hitch(this,function(){g.byNode(this.resultValue.domNode).set("disabled",!0)})));this._map._newExtent=a[0]}))},_showCoordinates:function(a){var b;this._map.snappingManager&&
(b=this._map.snappingManager._snappingPoint);a=this._getGCSLocation(b||a.mapPoint);this.map.spatialReference._isWrappable()||(180<a.x?a.x=180:-180>a.x&&(a.x=-180));this.mouseLocationX=a.x;this.mouseLocationY=a.y;this._outputLocationResult(this.mouseLocationX,this.mouseLocationY,g.byNode(this.unit.domNode).label)},_updateStaticState:function(a){this.markerLocationX=this.mouseLocationX=a.x;this.markerLocationY=this.mouseLocationY=a.y;var b=this._calculateValueToDisplay(this.markerLocationX,this.markerLocationY,
this.units[this.currentLocationUnit]);this.markerLongitude.innerHTML=this.mouseLongitude.innerHTML=b[0];this.markerLatitude.innerHTML=this.mouseLatitude.innerHTML=b[1];this.onMeasureEnd(this.activeTool,a,b,this.getUnit())},_showStaticCoordinates:function(a){this._outOfBoundsCheck=[!1,1];this._toggleStaticLocationTable(!0,!1);var b,e;this._map.snappingManager&&(b=this._map.snappingManager._snappingPoint);a=b||a.mapPoint;this._interpolatedMap?(this.map.spatialReference._isWrappable()?a=a.normalize():
180<a.x?(a.x=180,this._outOfBoundsCheck=[!0,1]):-180>a.x&&(a.x=-180,this._outOfBoundsCheck=[!0,-1]),b=new E({wkid:4326}),this._geometryService.project([a],b,c.hitch(this,function(a){e=a[0];this._outOfBoundsCheck[0]&&(e.x=180*this._outOfBoundsCheck[1]);this._updateStaticState(e)}))):(e=this._getGCSLocation(a),this.map.spatialReference._isWrappable()||(180<e.x?(e.x=180,this._outOfBoundsCheck=[!0,1]):-180>e.x&&(e.x=-180,this._outOfBoundsCheck=[!0,-1])),this._updateStaticState(e))},_checkCS:function(a){if(a.wkid)return 3857===
a.wkid||102100===a.wkid||102113===a.wkid?"Web Mercator":P.isDefined(Q[a.wkid])?"PCS":"GCS";if(a.wkt)return-1!==a.wkt.indexOf("WGS_1984_Web_Mercator")?"Web Mercator":0===a.wkt.indexOf("PROJCS")?"PCS":"GCS"},_switchUnit:function(a){"distance"===this.activeTool?this.currentDistanceUnit=a:"area"===this.activeTool?this.currentAreaUnit=a:"location"===this.activeTool&&(this.currentLocationUnit=a);g.byNode(this.unit.domNode).set("label",this.units[a]);if(null!==this.result){var b=this._outputResult(this.result,
this.units[a]);this.onUnitChange(this.units[a],this.activeTool);if(null!==this.measureGraphic)this.onMeasureEnd(this.activeTool,this.measureGraphic.geometry,b,this.getUnit())}},_outputResult:function(a,b){var c=a*this.unitDictionary[b];0===c?g.byNode(this.resultValue.domNode).set("content","\x26nbsp"):1E6<c?g.byNode(this.resultValue.domNode).set("content",e.format(c.toPrecision(9),{pattern:this.numberPattern})+" "+b):10>c?g.byNode(this.resultValue.domNode).set("content",e.format(c.toFixed(2),{pattern:this.numberPattern+
"0"})+" "+b):g.byNode(this.resultValue.domNode).set("content",e.format(c.toFixed(2),{pattern:this.numberPattern})+" "+b);return c},_switchLocationUnit:function(a){var c,e;c=[];g.byNode(this.unit.domNode).set("label",this.units[a]);this.currentLocationUnit=a;b.disconnect(this.mouseMoveMapHandler);this.onUnitChange(this.units[a],this.activeTool);if("esriDegreeMinuteSeconds"===a||"esriDecimalDegrees"===a){if(this.mouseMoveMapHandler=b.connect(this._map,"onMouseMove",this,"_showCoordinates"),this._toggleStaticLocationTable(!0,
!1),!(null===this.result||null===this.mouseLocationX||null===this.mouseLocationY||"---"===this.mouseLongitude.innerHTML||null===this.mouseLongitude.innerHTML))if(this._outputLocationResult(this.mouseLocationX,this.mouseLocationY,this.units[a]),this.markerLocationX&&this.markerLocationY&&(c=this._calculateValueToDisplay(this.markerLocationX,this.markerLocationY,this.units[a]),this.markerLongitude.innerHTML=c[0],this.markerLatitude.innerHTML=c[1]),this.locationGraphic)this.onMeasureEnd(this.activeTool,
this.locationGraphic.geometry,c,this.getUnit())}else this._toggleStaticLocationTable(!1,!1),null===this.result||(null===this.mouseLocationX||null===this.mouseLocationY)||(c=this.markerLocationX||this.mouseLocationX,e=this.markerLocationY||this.mouseLocationY,a={coordinates:[[c,e]],sr:{wkid:4326},conversionType:this.units[a]},this.locationGraphic&&this._toGeoCoordinateString(a,this.locationGraphic.geometry,this.locationGraphic))},_toggleStaticLocationTable:function(a,b){b&&(this.resultValue.innerHTML=
"\x26nbsp",this.markerLongitude.innerHTML="---",this.markerLatitude.innerHTML="---",this.mouseLongitude.innerHTML="---",this.mouseLatitude.innerHTML="---");a?(x.show(this.resultTable.domNode),x.hide(this.resultValue.domNode)):(x.hide(this.resultTable.domNode),x.show(this.resultValue.domNode))},_calculateValueToDisplay:function(a,b,c){var e,f,g=s.widgets.measurement;c===g.NLS_decimal_degrees?(e=a.toFixed(6),f=b.toFixed(6),90<f?f=90:-90>f&&(f=-90),this.map.spatialReference._isWrappable()||(180<e?e=
180:-180>e&&(e=-180))):c===g.NLS_deg_min_sec&&(g=c=!1,0>a&&(c=!0,a=Math.abs(a)),0>b&&(g=!0,b=Math.abs(b)),90<b?b=90:-90>b&&(b=-90),this.map.spatialReference._isWrappable()||(180<a?a=180:-180>a&&(a=-180)),e=Math.floor(a)+"\u00b0"+Math.floor(60*(a-Math.floor(a)))+"'"+Math.floor(60*(60*(a-Math.floor(a))-Math.floor(60*(a-Math.floor(a)))))+'"',f=Math.floor(b)+"\u00b0"+Math.floor(60*(b-Math.floor(b)))+"'"+Math.floor(60*(60*(b-Math.floor(b))-Math.floor(60*(b-Math.floor(b)))))+'"',c&&(e="-"+e),g&&(f="-"+
f));return[e,f]},_outputLocationResult:function(a,b,c){a=this._calculateValueToDisplay(a,b,c);this.mouseLongitude.innerHTML=a[0];this.mouseLatitude.innerHTML=a[1]},_createLengthUnitList:function(){var a,b=new v({style:"display: none;"});a=s.widgets.measurement;var e="esriMiles esriKilometers esriFeet esriMeters esriYards esriNauticalMiles".split(" ");f.forEach([a.NLS_length_miles,a.NLS_length_kilometers,a.NLS_length_feet,a.NLS_length_meters,a.NLS_length_yards,a.NLS_length_nautical_miles],c.hitch(this,
function(a,d){var f=new k({label:a,onClick:c.hitch(this,function(){this._switchUnit(e[d])})});f.set("class","unitDropDown");b.addChild(f)}));g.byNode(this.unit.domNode).set("dropDown",b);this.currentDistanceUnit?(a=this.units[this.currentDistanceUnit],g.byNode(this.unit.domNode).set("label",a)):(a=this.units[this._defaultLengthUnit],g.byNode(this.unit.domNode).set("label",a),this.currentDistanceUnit=this._defaultLengthUnit);this.onToolChange(this.activeTool,this.getUnit())},_createAreaUnitList:function(){var a,
b=new v({style:"display: none;"});a=s.widgets.measurement;var e="esriAcres esriSquareMiles esriSquareKilometers esriHectares esriSquareYards esriSquareFeet esriSquareMeters".split(" ");f.forEach([a.NLS_area_acres,a.NLS_area_sq_miles,a.NLS_area_sq_kilometers,a.NLS_area_hectares,a.NLS_area_sq_yards,a.NLS_area_sq_feet,a.NLS_area_sq_meters],c.hitch(this,function(a,d){var f=new k({label:a,onClick:c.hitch(this,function(){this._switchUnit(e[d])})});f.set("class","unitDropDown");b.addChild(f)}));g.byNode(this.unit.domNode).set("dropDown",
b);this.currentAreaUnit?(a=this.units[this.currentAreaUnit],g.byNode(this.unit.domNode).set("label",a)):(a=this.units[this._defaultAreaUnit],g.byNode(this.unit.domNode).set("label",a),this.currentAreaUnit=this._defaultAreaUnit);this.onToolChange(this.activeTool,this.getUnit())},_createLocationUnitList:function(){var a;a=s.widgets.measurement;var b=[];a=[a.NLS_decimal_degrees,a.NLS_deg_min_sec,a.NLS_MGRS,a.NLS_USNG,a.NLS_UTM,a.NLS_GeoRef,a.NLS_GARS];var e="esriDecimalDegrees esriDegreeMinuteSeconds esriMGRS esriUSNG esriUTM esriGeoRef esriGARS".split(" "),
h=new v({style:"display: none;"}),b=this._geometryService&&this.advancedLocationUnits?a:[a[0],a[1]];f.forEach(b,c.hitch(this,function(a,b){var d=new k({label:a,onClick:c.hitch(this,function(){this._switchLocationUnit(e[b])})});d.set("class","unitDropDown");h.addChild(d)}));g.byNode(this.unit.domNode).set("dropDown",h);this.currentLocationUnit?a=this.units[this.currentLocationUnit]:(a=this.units[this._defaultLocationUnit],this.currentLocationUnit=this._defaultLocationUnit);g.byNode(this.unit.domNode).set("label",
a);if("location"!==this._previousTool)this.onToolChange(this.activeTool,a);("esriDegreeMinuteSeconds"===this.currentLocationUnit||"esriDecimalDegrees"===this.currentLocationUnit)&&this._toggleStaticLocationTable(!0,!1)},_drawPointGraphic:function(){var b,e,f,g;f=this._pointSymbol;e=q.create("div",{"class":"esriLocationResultSymbol"},this.pinCell);e=p.createSurface(e,10,10);9>n("ie")&&(b=e.getEventSource(),a.set(b,"position","relative"),a.set(b.parentNode,"position","relative"));f=f.getShapeDescriptors();
try{g=e.createShape(f.defaultShape).setFill(f.fill).setStroke(f.stroke)}catch(h){e.clear();e.destroy();return}var k=g.getBoundingBox();f=k.width;b=k.height;var l=-(k.x+f/2),k=-(k.y+b/2);e=e.getDimensions();e={dx:l+e.width/2,dy:k+e.height/2};if(10<f||10<b)f=5/(f/10>b/10?f:b),c.mixin(e,{xx:f,yy:f});g.applyTransform(e)}});n("extend-esri")&&c.setObject("dijit.Measurement",m,N);return m});